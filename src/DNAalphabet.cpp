/*
 * DNAalphabet.cpp
 *
 *  Created on: Jan 25, 2018
 *      Author: zhengqi
 */

#include <algorithm>
#include "DNAalphabet.h"

namespace EGriceLab {
namespace MSGseqTK {

const DNAalphabet::base_map DNAalphabet::sym2base = {
		0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
		0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
		0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
/*1-4*/ A, C, G, T, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
/*A-Z*/	0, A, B, C, D, 0, 0, G, H, 0, 0, K, 0, M, N, 0,
		0, 0, R, S, T, T, V, W, 0, Y, 0, 0, 0, 0, 0, 0,
/*a-z*/	0, A, B, C, D, 0, 0, G, H, 0, 0, K, 0, M, N, 0,
		0, 0, R, S, T, T, V, W, 0, Y, 0, 0, 0, 0, 0, 0,

		0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
		0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
		0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
		0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
		0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
		0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
		0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
		0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
};

const DNAalphabet::sym_map DNAalphabet::base2sym = {
		'N','A','C','M', 'G','R','S','V', 'T','W','Y','H', 'K','D','B','=',
		'=','=','=','=', '=','=','=','=', '=','=','=','=', '=','=','=','=',
		'=','=','=','=', '=','=','=','=', '=','=','=','=', '=','=','=','=',
		'=','=','=','=', '=','=','=','=', '=','=','=','=', '=','=','=','=',
		'=','=','=','=', '=','=','=','=', '=','=','=','=', '=','=','=','=',
		'=','=','=','=', '=','=','=','=', '=','=','=','=', '=','=','=','=',
		'=','=','=','=', '=','=','=','=', '=','=','=','=', '=','=','=','=',
		'=','=','=','=', '=','=','=','=', '=','=','=','=', '=','=','=','=',

		'=','=','=','=', '=','=','=','=', '=','=','=','=', '=','=','=','=',
		'=','=','=','=', '=','=','=','=', '=','=','=','=', '=','=','=','=',
		'=','=','=','=', '=','=','=','=', '=','=','=','=', '=','=','=','=',
		'=','=','=','=', '=','=','=','=', '=','=','=','=', '=','=','=','=',
		'=','=','=','=', '=','=','=','=', '=','=','=','=', '=','=','=','=',
		'=','=','=','=', '=','=','=','=', '=','=','=','=', '=','=','=','=',
		'=','=','=','=', '=','=','=','=', '=','=','=','=', '=','=','=','=',
		'=','=','=','=', '=','=','=','=', '=','=','=','=', '=','=','=','='
};

const DNAalphabet::sym_map DNAalphabet::sym2comp = {
		'=','=','=','=', '=','=','=','=', '=','=','=','=', '=','=','=','=',
		'=','=','=','=', '=','=','=','=', '=','=','=','=', '=','=','=','=',
		'=','=','=','=', '=','=','=','=', '=','=','=','=', '=','=','=','=',
		'=','=','=','=', '=','=','=','=', '=','=','=','=', '=','=','=','=',
/*A-Z*/	'=','T','V','G', 'H','=','=','C', 'D','=','=','M', '=','K','N','=',
		'=','=','Y','S', 'A','A','B','W', '=','R','=','=', '=','=','=','=',
/*a-z*/	'=','t','v','g', 'h','=','=','c', 'd','=','=','m', '=','k','n','=',
		'=','=','y','s', 'a','a','b','w', '=','r','=','=', '=','=','=','=',

		'=','=','=','=', '=','=','=','=', '=','=','=','=', '=','=','=','=',
		'=','=','=','=', '=','=','=','=', '=','=','=','=', '=','=','=','=',
		'=','=','=','=', '=','=','=','=', '=','=','=','=', '=','=','=','=',
		'=','=','=','=', '=','=','=','=', '=','=','=','=', '=','=','=','=',
		'=','=','=','=', '=','=','=','=', '=','=','=','=', '=','=','=','=',
		'=','=','=','=', '=','=','=','=', '=','=','=','=', '=','=','=','=',
		'=','=','=','=', '=','=','=','=', '=','=','=','=', '=','=','=','=',
		'=','=','=','=', '=','=','=','=', '=','=','=','=', '=','=','=','='
};

const DNAalphabet::base_map DNAalphabet::base2comp = {
		 N, T, G, K,  C, Y, S, B,  A, W, R, D,  M, H, V, 0,
		 0, 0, 0, 0,  0, 0, 0, 0,  0, 0, 0, 0,  0, 0, 0, 0,
		 0, 0, 0, 0,  0, 0, 0, 0,  0, 0, 0, 0,  0, 0, 0, 0,
		 0, 0, 0, 0,  0, 0, 0, 0,  0, 0, 0, 0,  0, 0, 0, 0,
		 0, 0, 0, 0,  0, 0, 0, 0,  0, 0, 0, 0,  0, 0, 0, 0,
		 0, 0, 0, 0,  0, 0, 0, 0,  0, 0, 0, 0,  0, 0, 0, 0,
		 0, 0, 0, 0,  0, 0, 0, 0,  0, 0, 0, 0,  0, 0, 0, 0,
		 0, 0, 0, 0,  0, 0, 0, 0,  0, 0, 0, 0,  0, 0, 0, 0,

		 0, 0, 0, 0,  0, 0, 0, 0,  0, 0, 0, 0,  0, 0, 0, 0,
		 0, 0, 0, 0,  0, 0, 0, 0,  0, 0, 0, 0,  0, 0, 0, 0,
		 0, 0, 0, 0,  0, 0, 0, 0,  0, 0, 0, 0,  0, 0, 0, 0,
		 0, 0, 0, 0,  0, 0, 0, 0,  0, 0, 0, 0,  0, 0, 0, 0,
		 0, 0, 0, 0,  0, 0, 0, 0,  0, 0, 0, 0,  0, 0, 0, 0,
		 0, 0, 0, 0,  0, 0, 0, 0,  0, 0, 0, 0,  0, 0, 0, 0,
		 0, 0, 0, 0,  0, 0, 0, 0,  0, 0, 0, 0,  0, 0, 0, 0,
		 0, 0, 0, 0,  0, 0, 0, 0,  0, 0, 0, 0,  0, 0, 0, 0
};

string DNAalphabet::revcom(const string& str) {
	string rcStr;
	rcStr.reserve(str.length());
	for(string::const_reverse_iterator s = str.rbegin(); s != str.rend(); ++s)
		rcStr.push_back(complement(*s));
	return rcStr;
}

} /* namespace MSGSeqClean */
} /* namespace EGriceLab */
